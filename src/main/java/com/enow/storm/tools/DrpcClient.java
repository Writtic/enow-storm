package com.enow.storm.tools;

/**
 * Created by writtic on 2016. 8. 15..
 */
import org.apache.storm.generated.DRPCExecutionException;
import org.apache.storm.utils.DRPCClient;
import org.apache.storm.utils.Utils;
import org.apache.storm.thrift.TException;
import java.util.Map;

public class DrpcClient {
    public static void main(String[] args) throws TException, DRPCExecutionException {
        Map conf = Utils.readStormConfig();
        DRPCClient client = new DRPCClient(conf, args[0], Integer.parseInt(args[1]));
        while (true) {
            System.out.println("Word count: " + client.execute("words", "cow"));
            Utils.sleep(1000);
        }
    }
}
